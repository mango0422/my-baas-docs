"use strict";(self.webpackChunkmy_baas_docs=self.webpackChunkmy_baas_docs||[]).push([[2087],{4353:(e,t,r)=>{r.r(t),r.d(t,{assets:()=>d,contentTitle:()=>c,default:()=>h,frontMatter:()=>a,metadata:()=>s,toc:()=>o});const s=JSON.parse('{"id":"msa-architecture/06-saga-pattern","title":"6. SAGA \ud328\ud134\uacfc \ubcf4\uc0c1 \ud2b8\ub79c\uc7ad\uc158","description":"6.1 \uc65c SAGA\uc778\uac00?","source":"@site/docs/msa-architecture/06-saga-pattern.mdx","sourceDirName":"msa-architecture","slug":"/msa-architecture/06-saga-pattern","permalink":"/my-baas-docs/docs/msa-architecture/06-saga-pattern","draft":false,"unlisted":false,"editUrl":"https://github.com/mango0422/my-baas-docs/blob/main/docs/msa-architecture/06-saga-pattern.mdx","tags":[],"version":"current","sidebarPosition":7,"frontMatter":{"id":"06-saga-pattern","title":"6. SAGA \ud328\ud134\uacfc \ubcf4\uc0c1 \ud2b8\ub79c\uc7ad\uc158","sidebar_position":7},"sidebar":"tutorialSidebar","previous":{"title":"5. \uc11c\ube44\uc2a4 \uac04 \ud1b5\uc2e0 \ud328\ud134: REST\xb7gRPC\xb7\uba54\uc2dc\uc9c0 \ube0c\ub85c\ucee4","permalink":"/my-baas-docs/docs/msa-architecture/05-communication-patterns"},"next":{"title":"7. Observability: \ub85c\uadf8\xb7\uba54\ud2b8\ub9ad\xb7\ud2b8\ub808\uc774\uc2f1","permalink":"/my-baas-docs/docs/msa-architecture/07-observability"}}');var n=r(4848),i=r(8453);const a={id:"06-saga-pattern",title:"6. SAGA \ud328\ud134\uacfc \ubcf4\uc0c1 \ud2b8\ub79c\uc7ad\uc158",sidebar_position:7},c=void 0,d={},o=[{value:"6.1 \uc65c SAGA\uc778\uac00?",id:"61-\uc65c-saga\uc778\uac00",level:3},{value:"6.2 \ub450 \uac00\uc9c0 \uc811\uadfc",id:"62-\ub450-\uac00\uc9c0-\uc811\uadfc",level:3},{value:"6.3 \uc608\uc81c: \ucd9c\uae08 \u2192 \uc785\uae08 SAGA (Armeria gRPC)",id:"63-\uc608\uc81c-\ucd9c\uae08--\uc785\uae08-saga-armeria-grpc",level:3}];function l(e){const t={code:"code",h3:"h3",li:"li",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,i.R)(),...e.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(t.h3,{id:"61-\uc65c-saga\uc778\uac00",children:"6.1 \uc65c SAGA\uc778\uac00?"}),"\n",(0,n.jsxs)(t.ul,{children:["\n",(0,n.jsxs)(t.li,{children:[(0,n.jsx)(t.strong,{children:"2PC"}),"\ub294 \ub77d\xb7\uc9c0\uc5f0\xb7\ub2e8\uc77c DB \uc885\uc18d \u2192 \ud074\ub77c\uc6b0\ub4dc MSA \ubd80\uc801\ud569"]}),"\n",(0,n.jsxs)(t.li,{children:["SAGA = ",(0,n.jsx)(t.strong,{children:"\uc5ec\ub7ec \uac1c\uc758 \ub85c\uceec \ud2b8\ub79c\uc7ad\uc158 + \uc774\ubca4\ud2b8/\uba85\ub839"})," \uc5f0\uc1c4"]}),"\n"]}),"\n",(0,n.jsx)(t.h3,{id:"62-\ub450-\uac00\uc9c0-\uc811\uadfc",children:"6.2 \ub450 \uac00\uc9c0 \uc811\uadfc"}),"\n",(0,n.jsxs)(t.table,{children:[(0,n.jsx)(t.thead,{children:(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.th,{children:"\ubc29\uc2dd"}),(0,n.jsx)(t.th,{children:"\uc7a5\uc810"}),(0,n.jsx)(t.th,{children:"\ub2e8\uc810"}),(0,n.jsx)(t.th,{children:"Spring/Armeria \uad6c\ud604"})]})}),(0,n.jsxs)(t.tbody,{children:[(0,n.jsxs)(t.tr,{children:[(0,n.jsxs)(t.td,{children:[(0,n.jsx)(t.strong,{children:"Choreography"}),(0,n.jsx)("br",{}),"(\uc774\ubca4\ud2b8 \uae30\ubc18)"]}),(0,n.jsx)(t.td,{children:"Orchestrator \uc5c6\uc74c, \ub2e8\uc21c"}),(0,n.jsx)(t.td,{children:"\uc11c\ube44\uc2a4 \uc218 \u2191 \u2192 \ubcf5\uc7a1"}),(0,n.jsxs)(t.td,{children:["Kafka Topic \uad6c\ub3c5",(0,n.jsx)("br",{}),(0,n.jsx)(t.code,{children:"@KafkaListener"})]})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsxs)(t.td,{children:[(0,n.jsx)(t.strong,{children:"Orchestration"}),(0,n.jsx)("br",{}),"(\uc911\uc559 \uc624\ucf00\uc2a4\ud2b8\ub808\uc774\ud130)"]}),(0,n.jsx)(t.td,{children:"\ud750\ub984 \uba85\ud655, \uad00\ub9ac \uc6a9\uc774"}),(0,n.jsx)(t.td,{children:"\ub2e8\uc77c \uc2e4\ud328\uc810 \uac00\ub2a5"}),(0,n.jsxs)(t.td,{children:["Armeria gRPC Orchestrator",(0,n.jsx)("br",{}),"Spring Boot Worker Services"]})]})]})]}),"\n",(0,n.jsx)(t.h3,{id:"63-\uc608\uc81c-\ucd9c\uae08--\uc785\uae08-saga-armeria-grpc",children:"6.3 \uc608\uc81c: \ucd9c\uae08 \u2192 \uc785\uae08 SAGA (Armeria gRPC)"}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-mermaid",children:"sequenceDiagram\nactor Client\nClient->>RemittanceService: POST /transfer\nRemittanceService-)Grpc: WithdrawService.Withdraw()\nalt Withdraw SUCCESS\n    RemittanceService-)Grpc: DepositService.Deposit()\n    alt Deposit FAIL\n        RemittanceService-)Grpc: WithdrawService.Compensate()\n    end\nend\n"})}),"\n",(0,n.jsxs)(t.ul,{children:["\n",(0,n.jsxs)(t.li,{children:[(0,n.jsx)(t.strong,{children:"\ubcf4\uc0c1 \ud2b8\ub79c\uc7ad\uc158"}),": ",(0,n.jsx)(t.code,{children:"WithdrawService.Compensate()"})]}),"\n",(0,n.jsxs)(t.li,{children:[(0,n.jsx)(t.strong,{children:"Idempotency"}),": ",(0,n.jsx)(t.code,{children:"x-remit-idempotent-key"})," \ud5e4\ub354 + PK \uc778\ub371\uc2a4"]}),"\n",(0,n.jsxs)(t.li,{children:[(0,n.jsx)(t.strong,{children:"Timeout & Retry"}),": ",(0,n.jsx)(t.code,{children:"Resilience4j"})," + gRPC stub ",(0,n.jsx)(t.code,{children:"withDeadlineAfter(...)"})]}),"\n"]})]})}function h(e={}){const{wrapper:t}={...(0,i.R)(),...e.components};return t?(0,n.jsx)(t,{...e,children:(0,n.jsx)(l,{...e})}):l(e)}},8453:(e,t,r)=>{r.d(t,{R:()=>a,x:()=>c});var s=r(6540);const n={},i=s.createContext(n);function a(e){const t=s.useContext(i);return s.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function c(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(n):e.components||n:a(e.components),s.createElement(i.Provider,{value:t},e.children)}}}]);