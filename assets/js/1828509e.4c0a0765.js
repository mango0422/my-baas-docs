"use strict";(self.webpackChunkmy_baas_docs=self.webpackChunkmy_baas_docs||[]).push([[1083],{4443:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>d,contentTitle:()=>l,default:()=>h,frontMatter:()=>c,metadata:()=>r,toc:()=>a});const r=JSON.parse('{"id":"msa-architecture/10-multi-tenancy-msa","title":"10. \uba40\ud2f0 \ud14c\ub10c\uc2dc MSA \uc804\ub7b5","description":"SaaS\ud615 \uae08\uc735 \ud50c\ub7ab\ud3fc\uc5d0\uc11c \ud14c\ub10c\ud2b8(\uace0\uac1d\uc0ac) \ubd84\ub9ac \ub294 \ud544\uc218 \uc694\uad6c \uc0ac\ud56d\uc785\ub2c8\ub2e4.","source":"@site/docs/msa-architecture/10-multi-tenancy-msa.mdx","sourceDirName":"msa-architecture","slug":"/msa-architecture/10-multi-tenancy-msa","permalink":"/my-baas-docs/docs/msa-architecture/10-multi-tenancy-msa","draft":false,"unlisted":false,"editUrl":"https://github.com/mango0422/my-baas-docs/blob/main/docs/msa-architecture/10-multi-tenancy-msa.mdx","tags":[],"version":"current","sidebarPosition":11,"frontMatter":{"id":"10-multi-tenancy-msa","title":"10. \uba40\ud2f0 \ud14c\ub10c\uc2dc MSA \uc804\ub7b5","sidebar_position":11},"sidebar":"tutorialSidebar","previous":{"title":"9. Outbox \ud328\ud134: \uc2e0\ub8b0\ud560 \uc218 \uc788\ub294 \uc774\ubca4\ud2b8 \ubc1c\ud589","permalink":"/my-baas-docs/docs/msa-architecture/09-outbox-pattern"},"next":{"title":"11. gRPC \uc644\uc804 \uc815\ubcf5: Spring Boot & Armeria","permalink":"/my-baas-docs/docs/msa-architecture/11-grpc-deep-dive"}}');var s=n(4848),i=n(8453);const c={id:"10-multi-tenancy-msa",title:"10. \uba40\ud2f0 \ud14c\ub10c\uc2dc MSA \uc804\ub7b5",sidebar_position:11},l=void 0,d={},a=[{value:"10.1 \uc218\uc900(Level)\ubcc4 \uaca9\ub9ac \uc635\uc158",id:"101-\uc218\uc900level\ubcc4-\uaca9\ub9ac-\uc635\uc158",level:2},{value:"10.2 Spring Boot \uad6c\ud604 (L1 \uc608\uc2dc)",id:"102-spring-boot-\uad6c\ud604-l1-\uc608\uc2dc",level:2},{value:"10.3 Armeria gRPC \uc608\uc2dc (L2+)",id:"103-armeria-grpc-\uc608\uc2dc-l2",level:2},{value:"10.4 \ub370\uc774\ud130 \uaca9\ub9ac \uccb4\ud06c\ub9ac\uc2a4\ud2b8",id:"104-\ub370\uc774\ud130-\uaca9\ub9ac-\uccb4\ud06c\ub9ac\uc2a4\ud2b8",level:2}];function o(e){const t={blockquote:"blockquote",code:"code",h2:"h2",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,i.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(t.blockquote,{children:["\n",(0,s.jsxs)(t.p,{children:["SaaS\ud615 \uae08\uc735 \ud50c\ub7ab\ud3fc\uc5d0\uc11c ",(0,s.jsx)(t.strong,{children:"\ud14c\ub10c\ud2b8(\uace0\uac1d\uc0ac) \ubd84\ub9ac"})," \ub294 \ud544\uc218 \uc694\uad6c \uc0ac\ud56d\uc785\ub2c8\ub2e4."]}),"\n"]}),"\n",(0,s.jsx)(t.h2,{id:"101-\uc218\uc900level\ubcc4-\uaca9\ub9ac-\uc635\uc158",children:"10.1 \uc218\uc900(Level)\ubcc4 \uaca9\ub9ac \uc635\uc158"}),"\n",(0,s.jsxs)(t.table,{children:[(0,s.jsx)(t.thead,{children:(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.th,{children:"\uc218\uc900"}),(0,s.jsx)(t.th,{children:"\ubc29\uc2dd"}),(0,s.jsx)(t.th,{children:"\uc7a5\uc810"}),(0,s.jsx)(t.th,{children:"\ub2e8\uc810"})]})}),(0,s.jsxs)(t.tbody,{children:[(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:(0,s.jsx)(t.strong,{children:"L1"})}),(0,s.jsx)(t.td,{children:"\ub370\uc774\ud130\ubca0\uc774\uc2a4 \uacf5\uc720, \uc2a4\ud0a4\ub9c8/Row \ud30c\ud2f0\uc154\ub2dd"}),(0,s.jsx)(t.td,{children:"\ube44\uc6a9 \ud6a8\uc728"}),(0,s.jsx)(t.td,{children:"\uc644\uc804 \uaca9\ub9ac \uc544\ub2d8"})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:(0,s.jsx)(t.strong,{children:"L2"})}),(0,s.jsx)(t.td,{children:"DB \uc778\uc2a4\ud134\uc2a4(Cluster) \ubd84\ub9ac"}),(0,s.jsx)(t.td,{children:"\ub370\uc774\ud130 \uaca9\ub9ac \u2191"}),(0,s.jsx)(t.td,{children:"\uc6b4\uc601 \ubcf5\uc7a1 \u2191"})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:(0,s.jsx)(t.strong,{children:"L3"})}),(0,s.jsx)(t.td,{children:"\uc11c\ube44\uc2a4 & \uc778\ud504\ub77c \uc804\ubd80 \ubd84\ub9ac"}),(0,s.jsx)(t.td,{children:"\uaddc\uc81c\xb7\ubcf4\uc548 \ucd5c\uc0c1"}),(0,s.jsx)(t.td,{children:"\ube44\uc6a9\xb7\ubc30\ud3ec \ubd80\ub2f4"})]})]})]}),"\n",(0,s.jsx)(t.h2,{id:"102-spring-boot-\uad6c\ud604-l1-\uc608\uc2dc",children:"10.2 Spring Boot \uad6c\ud604 (L1 \uc608\uc2dc)"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-yaml",children:"spring:\n  datasource:\n    url: jdbc:mysql://db:3306/baas?currentSchema=#{tenantSchema}\n"})}),"\n",(0,s.jsx)(t.p,{children:"Tenant Filter:"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-java",children:'public class TenantFilter extends OncePerRequestFilter {\n  protected void doFilterInternal(HttpServletRequest req, \u2026) {\n    String tenantId = req.getHeader("X-TENANT-ID");\n    TenantContext.set(tenantId);     // ThreadLocal\n    filterChain.doFilter(req, res);\n  }\n}\n'})}),"\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.code,{children:"AbstractRoutingDataSource"})," \ub85c \uc2a4\ud0a4\ub9c8\ub97c \uc2a4\uc704\uce6d."]}),"\n",(0,s.jsx)(t.h2,{id:"103-armeria-grpc-\uc608\uc2dc-l2",children:"10.3 Armeria gRPC \uc608\uc2dc (L2+)"}),"\n",(0,s.jsxs)(t.ol,{children:["\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.strong,{children:"Tenant-Aware gRPC Stub"}),": ",(0,s.jsx)(t.code,{children:"Metadata.Key<String> TENANT_ID"})]}),"\n",(0,s.jsxs)(t.li,{children:["\uc11c\ubc84\uc5d0\uc11c ",(0,s.jsx)(t.code,{children:"ClientRequestContext.current()"})," \ub85c \ucd94\ucd9c \u2192 DB \ub77c\uc6b0\ud305"]}),"\n",(0,s.jsx)(t.li,{children:"Kubernetes \ub124\uc784\uc2a4\ud398\uc774\uc2a4\ubcc4\ub85c DB Secret \ubd84\ub9ac"}),"\n"]}),"\n",(0,s.jsx)(t.h2,{id:"104-\ub370\uc774\ud130-\uaca9\ub9ac-\uccb4\ud06c\ub9ac\uc2a4\ud2b8",children:"10.4 \ub370\uc774\ud130 \uaca9\ub9ac \uccb4\ud06c\ub9ac\uc2a4\ud2b8"}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsxs)(t.li,{children:["\uac01 \ud14c\ub10c\ud2b8 ",(0,s.jsx)(t.strong,{children:"\ud0a4 \uad00\ub9ac(HSM)"})," \ubd84\ub9ac"]}),"\n",(0,s.jsxs)(t.li,{children:["\ub85c\uadf8\xb7\uba54\ud2b8\ub9ad\ub3c4 \ud14c\ub10c\ud2b8 \ud0dc\uadf8 \ubd80\ucc29 (",(0,s.jsx)(t.code,{children:"tenant_id"})," label)"]}),"\n",(0,s.jsxs)(t.li,{children:["SLA \ucc28\ub4f1 \uc801\uc6a9 \uc2dc ",(0,s.jsx)(t.strong,{children:"HPA"})," \uc815\ucc45\uc744 \ud14c\ub10c\ud2b8\ubcc4\ub85c \ubd84\uae30"]}),"\n"]})]})}function h(e={}){const{wrapper:t}={...(0,i.R)(),...e.components};return t?(0,s.jsx)(t,{...e,children:(0,s.jsx)(o,{...e})}):o(e)}},8453:(e,t,n)=>{n.d(t,{R:()=>c,x:()=>l});var r=n(6540);const s={},i=r.createContext(s);function c(e){const t=r.useContext(i);return r.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function l(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:c(e.components),r.createElement(i.Provider,{value:t},e.children)}}}]);